{"ast":null,"code":"import { userStoreAction } from '../reducers/userStore';\nimport { Cookies } from 'react-cookie';\nconst cookies = new Cookies();\nconst RegExpEmail = new RegExp('[a-zA-Z0-9]@.');\n// const RegExpGmail = new RegExp(/^[A-Z0-9._%+-]+@gmail.com$/i);\nconst RegExpPassword = new RegExp('^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%^&*])(?=.{8,})');\nexport const setUserAction = (data, typeForm) => {\n  return async dispatch => {\n    try {\n      if (Object.keys(data).length) {\n        let errorList = [];\n        if (!RegExpEmail.test(data.email)) {\n          errorList.push({\n            errorType: 'errorText',\n            message: `incorrect email`\n          });\n        }\n        if (!RegExpPassword.test(data.password)) {\n          errorList.push({\n            errorType: 'errorText',\n            message: `incorrect password`\n          });\n        }\n        if (!errorList.length) {\n          if (typeForm === 'register') {\n            const {\n              name,\n              email,\n              password\n            } = data;\n            const response = await fetch('http://localhost:8008/user/register', {\n              method: 'POST',\n              headers: {\n                'Content-Type': 'application/json'\n              },\n              body: JSON.stringify({\n                name,\n                email,\n                password\n              })\n            });\n            const res = await response.json();\n            if (response.ok) {\n              console.log(res);\n            }\n            if (response.status === 500) {\n              errorList.push({\n                errorType: 'errorText',\n                message: `User already`\n              });\n            }\n          }\n          if (typeForm === 'login') {\n            const response = await fetch('http://localhost:8008/user/login', {\n              method: 'POST',\n              headers: {\n                'Content-Type': 'application/json'\n              },\n              body: JSON.stringify(data)\n            });\n            const res = await response.json();\n            if (response.ok) {\n              cookies.set('access_token', res.access_token);\n              cookies.set('refresh_token', res.refresh_token);\n              dispatch(userStoreAction.setUserData(res.user));\n            }\n            if (response.status === 500) {\n              errorList.push({\n                errorType: 'errorText',\n                message: `Email or password incorrect`\n              });\n            }\n          }\n          if (typeForm === 'setting') {\n            const response = await fetch('http://localhost:8008/user/setting', {\n              method: 'POST',\n              headers: {\n                'Content-Type': 'application/json',\n                Authorization: cookies.get('access_token')\n              },\n              body: JSON.stringify(data)\n            });\n            if (response.ok) {\n              console.log('Setting success');\n            }\n          }\n        }\n        dispatch(userStoreAction.setLoginError(errorList));\n      }\n    } catch (error) {\n      console.error('hi-808: ', error);\n      return error;\n    }\n  };\n};","map":{"version":3,"names":["userStoreAction","Cookies","cookies","RegExpEmail","RegExp","RegExpPassword","setUserAction","data","typeForm","dispatch","Object","keys","length","errorList","test","email","push","errorType","message","password","name","response","fetch","method","headers","body","JSON","stringify","res","json","ok","console","log","status","set","access_token","refresh_token","setUserData","user","Authorization","get","setLoginError","error"],"sources":["C:/Users/TNMYP/Documents/GitHub/Movies-808/Hi_808_V2/front-end-update/src/store/actions/userAction.js"],"sourcesContent":["import { userStoreAction } from '../reducers/userStore';\r\nimport { Cookies } from 'react-cookie';\r\nconst cookies = new Cookies();\r\n\r\nconst RegExpEmail = new RegExp('[a-zA-Z0-9]@.');\r\n// const RegExpGmail = new RegExp(/^[A-Z0-9._%+-]+@gmail.com$/i);\r\nconst RegExpPassword = new RegExp(\r\n  '^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%^&*])(?=.{8,})'\r\n);\r\n\r\nexport const setUserAction = (data, typeForm) => {\r\n  return async (dispatch) => {\r\n    try {\r\n      if (Object.keys(data).length) {\r\n        let errorList = [];\r\n        if (!RegExpEmail.test(data.email)) {\r\n          errorList.push({\r\n            errorType: 'errorText',\r\n            message: `incorrect email`,\r\n          });\r\n        }\r\n        if (!RegExpPassword.test(data.password)) {\r\n          errorList.push({\r\n            errorType: 'errorText',\r\n            message: `incorrect password`,\r\n          });\r\n        }\r\n\r\n        if (!errorList.length) {\r\n          if (typeForm === 'register') {\r\n            const { name, email, password } = data;\r\n            const response = await fetch(\r\n              'http://localhost:8008/user/register',\r\n              {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({ name, email, password }),\r\n              }\r\n            );\r\n            const res = await response.json();\r\n            if (response.ok) {\r\n              console.log(res);\r\n            }\r\n            if (response.status === 500) {\r\n              errorList.push({\r\n                errorType: 'errorText',\r\n                message: `User already`,\r\n              });\r\n            }\r\n          }\r\n          if (typeForm === 'login') {\r\n            const response = await fetch('http://localhost:8008/user/login', {\r\n              method: 'POST',\r\n              headers: { 'Content-Type': 'application/json' },\r\n              body: JSON.stringify(data),\r\n            });\r\n            const res = await response.json();\r\n            if (response.ok) {\r\n              cookies.set('access_token', res.access_token);\r\n              cookies.set('refresh_token', res.refresh_token);\r\n              dispatch(userStoreAction.setUserData(res.user));\r\n            }\r\n            if (response.status === 500) {\r\n              errorList.push({\r\n                errorType: 'errorText',\r\n                message: `Email or password incorrect`,\r\n              });\r\n            }\r\n          }\r\n          if (typeForm === 'setting') {\r\n            const response = await fetch('http://localhost:8008/user/setting', {\r\n              method: 'POST',\r\n              headers: {\r\n                'Content-Type': 'application/json',\r\n                Authorization: cookies.get('access_token'),\r\n              },\r\n              body: JSON.stringify(data),\r\n            });\r\n            if (response.ok) {\r\n              console.log('Setting success');\r\n            }\r\n          }\r\n        }\r\n        dispatch(userStoreAction.setLoginError(errorList));\r\n      }\r\n    } catch (error) {\r\n      console.error('hi-808: ', error);\r\n      return error;\r\n    }\r\n  };\r\n};\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}